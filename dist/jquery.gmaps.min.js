!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var t=window.Gmaps||{};t=function(){function t(t,a,o){var r=this,o=o;r.index=o,r.id="jquery-gmaps-"+o,r.url="https://maps.googleapis.com/maps/api/js",r.key=r._getKey(t),r.zoom=r._getZoom(t),r.clustering=r._getClustering(t),r.lang=r._getLanguage(),r.locations=r._getLocations(t),r.$map=e(t),r.style=r._getStyle(a),r.map=null,r.markers=[],r.bounds=null,r.infowindows=[],e(t).addClass("googlemap");var n=document.createElement("div");e(n).addClass("googlemap-overview"),e(n).addClass(r.id),e(t).prepend(e(n)),r.script(!0)}return t}(),t.prototype.script=function(e){var t=this;if(0==t.index){var a=t.url;if(!t.key)return!1;a+="?key="+t.key;var o=document.createElement("script");if(o.type="text/javascript",o.src=a,o.id="gmaps-api",o.async=!0,o.defer=!0,document.body.appendChild(o),t.clustering){var r=document.createElement("script");r.type="text/javascript",r.src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",r.id="gmaps-clustering",r.async=!0,r.defer=!0,document.body.appendChild(r)}}var n=setInterval(function(){void 0!==window.google&&(window.clearInterval(n),t.create())},100)},t.prototype._getStyle=function(e){try{return e.style}catch(e){return!1}},t.prototype._getKey=function(t){return e(t).attr("data-key")},t.prototype._getZoom=function(t){var a=e(t).attr("data-zoom");return void 0!==a&&""!==a||(a=4),parseInt(a)},t.prototype._getLanguage=function(){var t=e("html"),a=t.attr("lang");return void 0!==a&&""!==a||(a="en"),a},t.prototype._getClustering=function(t){var a=Boolean(e(t).attr("data-clustering"));return void 0===a&&(a=!1),a},t.prototype._getLocations=function(t){var a=this,o=e(t).find(".marker"),r=[];return o.each(function(t,o){var n={lat:parseFloat(e(o).attr("data-lat")),lng:parseFloat(e(o).attr("data-lng")),html:e(o).html(),icon:a._getIcon(o),draggable:Boolean(e(o).attr("data-draggable"))};r.push(n)}),r},t.prototype._getIcon=function(t){var a=e(t).attr("data-marker-image"),o=parseInt(e(t).attr("data-marker-width")),r=parseInt(e(t).attr("data-marker-height"));return!(void 0===a||!e.isNumeric(o)||!e.isNumeric(r))&&{url:a,width:o,height:r}},t.prototype.create=function(){var t=this,a=e("."+t.id),o={};if(o.zoom=t.zoom,o.zoomControl=!0,o.mapTypeControl=!0,o.scaleControl=!0,o.streetViewControl=!0,o.rotateControl=!0,o.fullscreenControl=!0,!1!==t.style&&(o.styles=t.style),t.map=new google.maps.Map(a.get(0),o),e.each(t.locations,function(e,a){t.addMarker(a)}),t.$map.trigger("onLoad"),console.log(t.map),t.clustering){new MarkerClusterer(t.map,t.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},t.prototype.addMarker=function(t){var a=this,o={};if(o.position=new google.maps.LatLng(t.lat,t.lng),o.map=a.map,o.clickable=!0,o.animation=google.maps.Animation.DROP,!1!==t.icon){o.icon=t.icon;t.icon.url,new google.maps.Size(t.icon.width,t.icon.height)}!1!==t.draggable&&(o.draggable=!0);var r=new google.maps.Marker(o);a.markers.push(r);var n=new google.maps.InfoWindow({content:t.html});a.infowindows.push(n),r.addListener("click",function(){e.each(a.infowindows,function(e,t){t.close()}),n.open(a.map,r),a.map.setCenter(this.getPosition()),a.$map.trigger("onMarkerClick")}),a.map.setCenter(o.position)},t.prototype.setCenter=function(){var t=this,a=new google.maps.LatLngBounds;e.each(t.locations,function(e,t){var o=new google.maps.LatLng(t.lat,t.lng);a.extend(o)}),1===t.locations.length?t.map.setCenter(a.getCenter()):t.map.fitBounds(a)},e.fn.gmaps=function(){var e,a,o=this,r=arguments[0],n=Array.prototype.slice.call(arguments,1),i=o.length;for(e=0;e<i;e++)if("object"==typeof r||void 0===r?o[e].gmap=new t(o[e],r,e):a=o[e].gmap[r].apply(o[e].gmap,n),void 0!==a)return a;return o}});