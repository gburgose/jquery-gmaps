!function(t){"use strict";var e=window.Gmaps||{};e=function(){function e(e,o,a){var r=this;r.element=e,r.settings=o,r.$canvas=null,r.$map=t(e),r.index=a,r.id="jquery-gmaps-"+a,r._init(r.element)}return e}(),e.prototype._init=function(t){var e=this;e.getMapSettings(),e._canvas(t),e._scripts()},e.prototype._canvas=function(e){var o=this;o.$map.find(".googlemap-overview").length>0&&o.$map.find(".googlemap-overview").remove();var a=document.createElement("div");return t(a).addClass("googlemap-overview"),t(a).addClass(o.id),t(e).prepend(t(a)),o.$canvas=t(a)},e.prototype._scripts=function(){var e=this;if(0===t("#gmaps-api").length){var o="//maps.googleapis.com/maps/api/js";if(!e.key)return!1;o+="?key="+e.key;var a=document.createElement("script");if(a.type="text/javascript",a.src=o,a.id="gmaps-api",a.async=!0,a.defer=!0,document.body.appendChild(a),e.clustering){var r=document.createElement("script");r.type="text/javascript",r.src="//developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",r.id="gmaps-clustering",r.async=!0,r.defer=!0,document.body.appendChild(r)}}var n=setInterval(function(){void 0!==window.google&&(window.clearInterval(n),e.mapInit())},200)},e.prototype.getMapSettings=function(){var t=this;t.map=null,t.markers=[],t.bounds=null,t.infowindows=[],t.key=t.getMapKey(t.element),t.zoom=t.getMapZoom(t.element),t.clustering=t.getMapClustering(t.element),t.lang=t.getMapLanguage(),t.style=t.getMapStyle(t.settings),t.controlZoom=t.getMapControlZoom(t.element),t.controlType=t.getMapControlType(t.element),t.controlScale=t.getMapControlScale(t.element),t.controlStreetView=t.getMapControlStreetView(t.element),t.controlRotate=t.getMapControlRotate(t.element),t.controlFullscreen=t.getMapControlFullscreen(t.element),t.eventDraggable=t.getMapEventDraggable(t.element),t.eventDoubleClickZoom=t.getMapEventDoubleClickZoom(t.element),t.eventMouseWheel=t.getMapEventMouseWheel(t.element),t.locations=t.getLocations(t.element)},e.prototype.getMapLanguage=function(){var e=t("html"),o=e.attr("lang");return void 0!==o&&""!==o||(o="en"),o},e.prototype.getMapKey=function(e){return t(e).attr("data-key")},e.prototype.getMapZoom=function(e){var o=t(e).attr("data-zoom");return o="string"!=typeof o?4:parseInt(o)},e.prototype.getMapClustering=function(e){var o=Boolean(t(e).attr("data-clustering"));return void 0===o&&(o=!1),o},e.prototype.getMapControlZoom=function(e){var o=this,a=t(e).attr("data-control-zoom");return o.___getBoolean(a,!1)},e.prototype.getMapControlType=function(e){var o=this,a=t(e).attr("data-control-type");return o.___getBoolean(a,!1)},e.prototype.getMapControlScale=function(e){var o=this,a=t(e).attr("data-control-scale");return o.___getBoolean(a,!1)},e.prototype.getMapControlStreetView=function(e){var o=this,a=t(e).attr("data-control-streetview");return o.___getBoolean(a,!1)},e.prototype.getMapControlRotate=function(e){var o=this,a=t(e).attr("data-control-rotate");return o.___getBoolean(a,!1)},e.prototype.getMapControlFullscreen=function(e){var o=this,a=t(e).attr("data-control-fullscreen");return o.___getBoolean(a,!1)},e.prototype.getMapEventDraggable=function(e){var o=this,a=t(e).attr("data-event-draggable");return o.___getBoolean(a,!0)},e.prototype.getMapEventDoubleClickZoom=function(e){var o=this,a=t(e).attr("data-event-doubleclick"),r=o.___getBoolean(a,!0);return r=!1===r},e.prototype.getMapEventMouseWheel=function(e){var o=this,a=t(e).attr("data-event-mousewheel");return o.___getBoolean(a,!1)},e.prototype.getMapStyle=function(t){try{return t.style}catch(t){return!1}},e.prototype.getLocations=function(e){var o=this,a=t(e).find(".marker"),r=[];return a.each(function(e,a){var a={id:o.getMarkerID(a),lat:t(a).attr("data-lat"),lng:t(a).attr("data-lng"),html:t(a).html(),icon:o.getMarkerIcon(a),draggable:o.getMarkerEventDraggable(a)};r.push(a)}),r},e.prototype.mapInit=function(){var e=this,o={};if(o.zoom=e.zoom,o.zoomControl=e.controlZoom,o.mapTypeControl=e.controlType,o.scaleControl=e.controlScale,o.streetViewControl=e.controlStreetView,o.rotateControl=e.controlRotate,o.fullscreenControl=e.controlFullscreen,o.draggable=e.eventDraggable,o.disableDoubleClickZoom=e.eventDoubleClickZoom,o.scrollwheel=e.eventMouseWheel,e.$map.addClass("googlemap").addClass("googlemap-load"),!1!==e.style&&(o.styles=e.style),e.map=new google.maps.Map(e.$canvas.get(0),o),t.each(e.locations,function(t,o){e.addMarker(o)}),e.$map.trigger("onLoad"),e.setCenter(),e.clustering){new MarkerClusterer(e.map,e.markers,{imagePath:"//developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},e.prototype.getMarkerID=function(e){var o=this,a=t(e).attr("data-id");return a=void 0===a?o.___randomId(10):o.___slugify(a)},e.prototype.getMarkerIcon=function(e){var o=t(e).attr("data-marker-image"),a=parseInt(t(e).attr("data-marker-width")),r=parseInt(t(e).attr("data-marker-height"));return!(void 0===o||!t.isNumeric(a)||!t.isNumeric(r))&&{url:o,width:a,height:r}},e.prototype.getMarkerEventDraggable=function(e){var o=Boolean(t(e).attr("data-draggable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.getMarkerEventClickeable=function(e){var o=Boolean(t(e).attr("data-clickeable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.addMarker=function(e){var o=this,a={};if(a.id=e.id,a.position=new google.maps.LatLng(e.lat,e.lng),a.map=o.map,a.clickable=!0,a.animation=google.maps.Animation.DROP,!1!==e.icon){a.icon=e.icon;e.icon.url,new google.maps.Size(e.icon.width,e.icon.height)}!1!==e.draggable&&(a.draggable=!0);var r=new google.maps.Marker(a);o.markers.push(r);var n=new google.maps.InfoWindow({content:e.html});o.infowindows.push(n),r.addListener("click",function(){t.each(o.infowindows,function(t,e){e.close()}),n.open(o.map,r),o.map.setCenter(this.getPosition());var a={};a.lat=parseFloat(r.getPosition().lat()),a.lng=parseFloat(r.getPosition().lng()),o.$map.trigger("onMarkerClick",[a,e.id])}),o.map.setCenter(a.position)},e.prototype.openMarker=function(e){var o=this;t.each(o.markers,function(t,o){o.id===e&&new google.maps.event.trigger(o,"click")})},e.prototype.setCenter=function(){var e=this,o=new google.maps.LatLngBounds;t.each(e.locations,function(t,e){var a=new google.maps.LatLng(e.lat,e.lng);o.extend(a)}),1===e.locations.length?e.map.setCenter(o.getCenter()):e.map.fitBounds(o)},e.prototype.reload=function(){var t=this;t._init(t.element)},e.prototype.destroy=function(){},e.prototype.___getBoolean=function(t,e){var o=e;return"true"===t?o=!0:"false"===t&&(o=!1),o},e.prototype.___slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},e.prototype.___randomId=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="",a=0;a<t;a++){var r=Math.floor(Math.random()*e.length);o+=e.substring(r,r+1)}return o.toLowerCase()},t.fn.gmaps=function(){var t,o,a=this,r=arguments[0],n=Array.prototype.slice.call(arguments,1),l=a.length;for(t=0;t<l;t++)if("object"==typeof r||void 0===r?a[t].gmap=new e(a[t],r,t):o=a[t].gmap[r].apply(a[t].gmap,n),void 0!==o)return o;return a}}(jQuery);