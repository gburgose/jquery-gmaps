!function(t){"use strict";var e=window.Gmaps||{};e=function(){function e(e,o,r){var a=this;a.element=e,a.settings=o,a.$canvas=null,a.$map=t(e),a.index=r,a.id="jquery-gmaps-"+r,a.map=null,a.markers=[],a.bounds=null,a.infowindows=[],a.properties=[],a.properties.map=[],a.properties.map.api=[],a.properties.map.option=[],a.properties.map.control=[],a.properties.map.event=[],a.locations=a.getLocations(a.element),a._init(a.element)}return e}(),e.prototype._init=function(t){var e=this;e._getMapProperties(),e._canvas(),e._scripts()},e.prototype._canvas=function(){var e=this;e.$map.find(".googlemap-overview").length>0&&e.$map.find(".googlemap-overview").remove();var o=document.createElement("div");return t(o).addClass("googlemap-overview"),t(o).addClass(e.id),t(e.element).prepend(t(o)),e.$canvas=t(o)},e.prototype._scripts=function(){var e=this;if(0===t("#gmaps-api").length){var o="//maps.googleapis.com/maps/api/js";o+="?key="+e.properties.map.api.key,o+="&language="+e.properties.map.api.lang;var r=document.createElement("script");if(r.type="text/javascript",r.src=o,r.id="gmaps-api",r.async=!0,r.defer=!0,document.body.appendChild(r),e.properties.map.option.clustering){var a=document.createElement("script");a.type="text/javascript",a.src="//developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",a.id="gmaps-clustering",a.async=!0,a.defer=!0,document.body.appendChild(a)}}var p=setInterval(function(){void 0!==window.google&&(window.clearInterval(p),e.mapInit())},200)},e.prototype._getMapProperties=function(){var t=this;t.properties.map.style=t._getMapStyle(t.settings),t.properties.map.api.key=t._getMapApiKey(void 0),t.properties.map.api.lang=t._getMapApiLanguage("en"),t.properties.map.option.zoom=t._getMapOptionZoom(4),t.properties.map.option.zoom_min=t._getMapOptionZoomMin(1),t.properties.map.option.zoom_max=t._getMapOptionZoomMax(16),t.properties.map.option.type=t._getMapOptionType("roadmap"),t.properties.map.option.clustering=t._getMapOptionClustering(!1),t.properties.map.control.zoom=t._getMapControlZoom(!1),t.properties.map.control.type=t._getMapControlType(!1),t.properties.map.control.scale=t._getMapControlScale(!1),t.properties.map.control.streetview=t._getMapControlStreetView(!1),t.properties.map.control.rotate=t._getMapControlRotate(!1),t.properties.map.control.fullscreen=t._getMapControlFullscreen(!1),t.properties.map.event.draggable=t._getMapEventDraggable(!0),t.properties.map.event.dblclickZoom=t._getMapEventControlClickZoom(!0),t.properties.map.event.scrollwheel=t._getMapEventScrollWheel(!1)},e.prototype._getMapApiKey=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-key");try{r=e.settings.api.key}catch(t){}return"string"==typeof a?a:"string"==typeof r?e.settings.api.key:o},e.prototype._getMapApiLanguage=function(e){var o=this,r=e,a=null,p=o.$map.attr("data-lang"),n=t("html").attr("lang");try{a=o.settings.api.lang}catch(t){}return"string"==typeof p?p:"string"==typeof a?o.settings.api.lang:"string"==typeof n?n:r},e.prototype._getMapOptionZoom=function(t){var e,o=this,r=t,a=null,p=parseInt(o.$map.attr("data-zoom"));try{a=parseInt(o.settings.map.zoom)}catch(t){}return e="number"==typeof p&&p>0?p:"number"==typeof a&&a>0?o.settings.map.zoom:r,e>0&&e<17&&(e=r),e},e.prototype._getMapOptionZoomMin=function(t){var e,o=this,r=t,a=null,p=parseInt(o.$map.attr("data-zoom-min"));try{a=parseInt(o.settings.map.zoom_min)}catch(t){}return e="number"==typeof p&&p>0?p:"number"==typeof a&&a>0?a:r,e>0&&e<17&&(e=r),e},e.prototype._getMapOptionZoomMax=function(t){var e,o=this,r=t,a=null,p=parseInt(o.$map.attr("data-zoom-max"));try{a=parseInt(o.settings.map.zoom_max)}catch(t){}return e="number"==typeof p&&p>0?p:"number"==typeof a&&a>0?a:r,e>0&&e<17&&(e=r),e},e.prototype._getMapOptionType=function(t){var e,o=this,r=t,a=null,p=o.$map.attr("data-type");try{a=o.settings.map.type}catch(t){}return e="string"==typeof p&&void 0!==p?p:"string"==typeof a&&void 0!==a?a:r,"roadmap"===e&&"satellite"===e&&"hybrid"===e&&"terrain"===e||(e=t),e},e.prototype._getMapOptionClustering=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-clustering");try{r=e.settings.map.clustering}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlZoom=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-zoom");try{r=e.settings.control.zoom}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlType=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-type");try{r=e.settings.control.type}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlScale=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-scale");try{r=e.settings.control.scale}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlStreetView=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-streetview");try{r=e.settings.control.streetview}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlRotate=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-rotate");try{r=e.settings.control.rotate}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapControlFullscreen=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-fullscreen");try{r=e.settings.control.fullscreen}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapEventControlClickZoom=function(t){var e,o=this,r=t,a=null,p=o.$map.attr("data-event-dblclickzoom");try{a=o.settings.event.dblclickZoom}catch(t){}return e="boolean"!=typeof p||"true"==typeof p&&"false"==typeof p?"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?r:a:p,e=!0!==e},e.prototype._getMapEventDraggable=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-control-fullscreen");try{r=e.settings.control.fullscreen}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapEventScrollWheel=function(t){var e=this,o=t,r=null,a=e.$map.attr("data-event-scrollwheel");try{r=e.settings.event.scrollwheel}catch(t){}return"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?"boolean"!=typeof r||"true"==typeof r&&"false"==typeof r?o:r:a},e.prototype._getMapStyle=function(t){try{return t.style}catch(t){return!1}},e.prototype.getLocations=function(e){var o=this,r=t(e).find(".marker"),a=[];return r.each(function(e,r){var p=t(r).attr("data-lat"),n=t(r).attr("data-lng"),i=t(r).attr("data-id"),r={id:o.getMarkerID(i),lat:p,lng:n,html:t(r).html(),icon:o.getMarkerIcon(r),draggable:o.getMarkerEventDraggable(r)};a.push(r)}),a},e.prototype.mapInit=function(){var e=this,o={};if(o.zoom=e.properties.map.option.zoom,o.minZoom=e.properties.map.option.zoom_min,o.maxZoom=e.properties.map.option.zoom_max,o.mapTypeId=e.properties.map.option.type,o.zoomControl=e.properties.map.control.zoom,o.mapTypeControl=e.properties.map.control.type,o.scaleControl=e.properties.map.control.scale,o.streetViewControl=e.properties.map.control.streetview,o.rotateControl=e.properties.map.control.rotate,o.fullscreenControl=e.properties.map.control.fullscreen,o.draggable=e.properties.map.event.draggable,o.disableDoubleClickZoom=e.properties.map.event.dblclickZoom,o.scrollwheel=e.properties.map.event.scrollwheel,e.$map.addClass("googlemap").addClass("googlemap-load"),!1!==e.properties.map.style&&(o.styles=e.properties.map.style),e.map=new google.maps.Map(e.$canvas.get(0),o),t.each(e.locations,function(t,o){e.addMarker(o)}),e.$map.trigger("onLoad"),e.setCenter(),e.properties.map.option.clustering){new MarkerClusterer(e.map,e.markers,{imagePath:"//developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},e.prototype.getMarkerID=function(t){var e=this,o=t;return void 0===o?e.___createId(10):e.___slugify(o)},e.prototype.getMarkerIcon=function(e){var o=t(e).attr("data-marker-image"),r=parseInt(t(e).attr("data-marker-width")),a=parseInt(t(e).attr("data-marker-height"));return!(void 0===o||!t.isNumeric(r)||!t.isNumeric(a))&&{url:o,width:r,height:a}},e.prototype.getMarkerEventDraggable=function(e){var o=Boolean(t(e).attr("data-draggable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.getMarkerEventClickeable=function(e){var o=Boolean(t(e).attr("data-clickeable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.addMarker=function(e){var o=this,r={};if(r.id=e.id,r.position=new google.maps.LatLng(e.lat,e.lng),r.map=o.map,r.clickable=!0,r.animation=google.maps.Animation.DROP,!1!==e.icon){r.icon=e.icon;e.icon.url,new google.maps.Size(e.icon.width,e.icon.height)}!1!==e.draggable&&(r.draggable=!0);var a=new google.maps.Marker(r);o.markers.push(a);var p=new google.maps.InfoWindow({content:e.html});o.infowindows.push(p),a.addListener("click",function(){t.each(o.infowindows,function(t,e){e.close()}),p.open(o.map,a),o.map.setCenter(this.getPosition());var r={};r.lat=parseFloat(a.getPosition().lat()),r.lng=parseFloat(a.getPosition().lng()),o.$map.trigger("onMarkerClick",[r,e.id])}),o.map.setCenter(r.position)},e.prototype.openMarker=function(e){var o=this;t.each(o.markers,function(t,o){o.id===e&&new google.maps.event.trigger(o,"click")})},e.prototype.setCenter=function(){var e=this,o=new google.maps.LatLngBounds;t.each(e.locations,function(t,e){var r=new google.maps.LatLng(e.lat,e.lng);o.extend(r)}),1===e.locations.length?e.map.setCenter(o.getCenter()):e.map.fitBounds(o)},e.prototype.reload=function(){var t=this;t._init(t.element)},e.prototype.destroy=function(){},e.prototype.___getLatLng=function(t,e){return new google.maps.LatLng(t,e)},e.prototype.___slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},e.prototype.___createId=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="",r=0;r<t;r++){var a=Math.floor(Math.random()*e.length);o+=e.substring(a,a+1)}return o.toLowerCase()},e.prototype.___log=function(t){},t.fn.gmaps=function(){var t,o,r=this,a=arguments[0],p=Array.prototype.slice.call(arguments,1),n=r.length;for(t=0;t<n;t++)if("object"==typeof a||void 0===a?r[t].gmap=new e(r[t],a,t):o=r[t].gmap[a].apply(r[t].gmap,p),void 0!==o)return o;return r}}(jQuery);