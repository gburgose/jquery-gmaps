!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e=window.Gmaps||{};e=function(){function e(e,o,a){var r=this;r.element=e,r.settings=o,r.$map=t(e),r.index=a,r.id="jquery-gmaps-"+a,r.getMapSettings(),r._canvas(e),r._scripts()}return e}(),e.prototype._canvas=function(e){var o=this,a=document.createElement("div");return t(a).addClass("googlemap-overview"),t(a).addClass(o.id),t(e).prepend(t(a))},e.prototype._scripts=function(){var t=this;if(0==t.index){var e="https://maps.googleapis.com/maps/api/js";if(!t.key)return!1;e+="?key="+t.key;var o=document.createElement("script");if(o.type="text/javascript",o.src=e,o.id="gmaps-api",o.async=!0,o.defer=!0,document.body.appendChild(o),t.clustering){var a=document.createElement("script");a.type="text/javascript",a.src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",a.id="gmaps-clustering",a.async=!0,a.defer=!0,document.body.appendChild(a)}}var r=setInterval(function(){void 0!==window.google&&(window.clearInterval(r),t.mapInit())},200)},e.prototype.getMapSettings=function(){var t=this;t.map=null,t.markers=[],t.bounds=null,t.infowindows=[],t.key=t.getMapKey(t.element),t.zoom=t.getMapZoom(t.element),t.clustering=t.getMapClustering(t.element),t.lang=t.getMapLanguage(),t.draggable=t.getMapDraggable(t.element),t.style=t.getMapStyle(t.settings),t.zoomControl=t.getMapZoomControl(t.element),t.typeControl=t.getMapTypeControl(t.element),t.scaleControl=t.getMapScaleControl(t.element),t.streetViewControl=t.getMapStreetViewControl(t.element),t.rotateControl=t.getMapRotateControl(t.element),t.fullscreenControl=t.getMapFullscreenControl(t.element),t.locations=t.getLocations(t.element)},e.prototype.getMapLanguage=function(){var e=t("html"),o=e.attr("lang");return void 0!==o&&""!==o||(o="en"),o},e.prototype.getMapStyle=function(t){try{return t.style}catch(t){return!1}},e.prototype.getMapKey=function(e){return t(e).attr("data-key")},e.prototype.getMapZoom=function(e){var o=t(e).attr("data-zoom");return o="string"!=typeof o?4:parseInt(o)},e.prototype.getMapZoomControl=function(e){var o=t(e).attr("data-control-zoom");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapTypeControl=function(e){var o=t(e).attr("data-control-type");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapScaleControl=function(e){var o=t(e).attr("data-control-scale");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapStreetViewControl=function(e){var o=t(e).attr("data-control-streetview");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapRotateControl=function(e){var o=t(e).attr("data-control-rotate");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapFullscreenControl=function(e){var o=t(e).attr("data-control-fullscreen");return o="string"==typeof o&&Boolean(o)},e.prototype.getMapDraggable=function(e){var o=t(e).attr("data-draggable");return o="string"!=typeof o||Boolean(o)},e.prototype.getMapClustering=function(e){var o=Boolean(t(e).attr("data-clustering"));return void 0===o&&(o=!1),o},e.prototype.mapInit=function(){var e=this,o={};o.zoom=e.zoom,o.zoomControl=e.zoomControl,o.mapTypeControl=e.typeControl,o.scaleControl=e.scaleControl,o.streetViewControl=e.streetViewControl,o.rotateControl=e.rotateControl,o.fullscreenControl=e.fullscreenControl,o.draggable=e.draggable,o.disableDoubleClickZoom=!1,o.scrollwheel=!1,e.$map.addClass("googlemap").addClass("googlemap-load"),!1!==e.style&&(o.styles=e.style);var a=t("."+e.id);if(e.map=new google.maps.Map(a.get(0),o),t.each(e.locations,function(t,o){e.addMarker(o)}),e.$map.trigger("onLoad"),e.setCenter(),e.clustering){new MarkerClusterer(e.map,e.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},e.prototype.getLocations=function(e){var o=this,a=t(e).find(".marker"),r=[];return a.each(function(e,a){var n={id:parseFloat(t(a).attr("data-id")),lat:parseFloat(t(a).attr("data-lat")),lng:parseFloat(t(a).attr("data-lng")),html:t(a).html(),icon:o.getMarkerIcon(a),draggable:o.getMarkerDraggable(a)};r.push(n)}),console.log(r),r},e.prototype.getMarkerIcon=function(e){var o=t(e).attr("data-marker-image"),a=parseInt(t(e).attr("data-marker-width")),r=parseInt(t(e).attr("data-marker-height"));return!(void 0===o||!t.isNumeric(a)||!t.isNumeric(r))&&{url:o,width:a,height:r}},e.prototype.getMarkerDraggable=function(e){var o=Boolean(t(e).attr("data-draggable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.addMarker=function(e){var o=this,a={};if(a.id=e.id,a.position=new google.maps.LatLng(e.lat,e.lng),a.map=o.map,a.clickable=!0,a.animation=google.maps.Animation.DROP,!1!==e.icon){a.icon=e.icon;e.icon.url,new google.maps.Size(e.icon.width,e.icon.height)}!1!==e.draggable&&(a.draggable=!0);var r=new google.maps.Marker(a);o.markers.push(r);var n=new google.maps.InfoWindow({content:e.html});o.infowindows.push(n),r.addListener("click",function(){t.each(o.infowindows,function(t,e){e.close()}),n.open(o.map,r),o.map.setCenter(this.getPosition());var a={};a.lat=parseFloat(r.getPosition().lat()),a.lng=parseFloat(r.getPosition().lng()),o.$map.trigger("onMarkerClick",[a,e.id])}),o.map.setCenter(a.position)},e.prototype.setCenter=function(){var e=this,o=new google.maps.LatLngBounds;t.each(e.locations,function(t,e){var a=new google.maps.LatLng(e.lat,e.lng);o.extend(a)}),1===e.locations.length?e.map.setCenter(o.getCenter()):e.map.fitBounds(o)},e.prototype.reload=function(){},e.prototype.destroy=function(){},t.fn.gmaps=function(){var t,o,a=this,r=arguments[0],n=Array.prototype.slice.call(arguments,1),l=a.length;for(t=0;t<l;t++)if("object"==typeof r||void 0===r?a[t].gmap=new e(a[t],r,t):o=a[t].gmap[r].apply(a[t].gmap,n),void 0!==o)return o;return a}});