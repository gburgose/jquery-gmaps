!function(t){"use strict";var e=window.Gmaps||{};e=function(){function e(e,o,a){var n=this;n.element=e,n.settings=o,n.$canvas=null,n.$map=t(e),n.index=a,n.id="jquery-gmaps-"+a,n.map=null,n.markers=[],n.bounds=null,n.infowindows=[],n.config=[],n.config.map=[],n.config.map.api=[],n.config.map.options=[],n.config.map.controls=[],n.config.map.events=[],n.locations=n.getLocations(n.element),n._init(n.element)}return e}(),e.prototype._init=function(t){var e=this;e._getMapConfiguration(),e._canvas(t),e._scripts()},e.prototype._canvas=function(e){var o=this;o.$map.find(".googlemap-overview").length>0&&o.$map.find(".googlemap-overview").remove();var a=document.createElement("div");return t(a).addClass("googlemap-overview"),t(a).addClass(o.id),t(e).prepend(t(a)),o.$canvas=t(a)},e.prototype._scripts=function(){var e=this;if(0===t("#gmaps-api").length){var o="//maps.googleapis.com/maps/api/js";o+="?key="+e.config.map.api.key,o+="&language="+e.config.map.api.lang;var a=document.createElement("script");if(a.type="text/javascript",a.src=o,a.id="gmaps-api",a.async=!0,a.defer=!0,document.body.appendChild(a),e.config.map.options.clustering){var n=document.createElement("script");n.type="text/javascript",n.src="//developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",n.id="gmaps-clustering",n.async=!0,n.defer=!0,document.body.appendChild(n)}}var r=setInterval(function(){void 0!==window.google&&(window.clearInterval(r),e.mapInit())},200)},e.prototype._getMapConfiguration=function(){var t=this;t.config.map.style=t._getMapStyle(t.settings),t.config.map.api.key=t._getMapApiKey(void 0),t.config.map.api.lang=t._getMapApiLanguage("en"),t.config.map.options.zoom=t._getMapOptionZoom(4),t.config.map.options.zoom_min=t._getMapOptionZoomMin(1),t.config.map.options.zoom_max=t._getMapOptionZoomMax(16),t.config.map.options.type=t._getMapOptionType("roadmap"),t.config.map.options.clustering=t._getMapOptionClustering(!1),t.config.map.controls.zoom=t._getMapControlZoom(!1),t.config.map.controls.type=t._getMapControlType(!1),t.config.map.controls.scale=t._getMapControlScale(!1),t.config.map.controls.streetView=t._getMapControlStreetView(!1),t.controlRotate=t._getMapControlRotate(t.element),t.controlFullscreen=t._getMapControlFullscreen(t.element),t.eventDraggable=t._getMapEventDraggable(t.element),t.eventDoubleClickZoom=t._getMapEventDoubleClickZoom(t.element),t.eventMouseWheel=t._getMapEventMouseWheel(t.element)},e.prototype._getMapApiKey=function(t){var e=this,o=t,a=null,n=e.$map.attr("data-key");try{a=e.settings.api.key}catch(t){}return"string"==typeof n?n:"string"==typeof a?e.settings.api.key:o},e.prototype._getMapApiLanguage=function(e){var o=this,a=e,n=null,r=o.$map.attr("data-lang"),p=t("html").attr("lang");try{n=o.settings.api.lang}catch(t){}return"string"==typeof r?r:"string"==typeof n?o.settings.api.lang:"string"==typeof p?p:a},e.prototype._getMapOptionZoom=function(t){var e,o=this,a=t,n=null,r=parseInt(o.$map.attr("data-zoom"));try{n=parseInt(o.settings.map.zoom)}catch(t){}return e="number"==typeof r&&r>0?r:"number"==typeof n&&n>0?o.settings.map.zoom:a,(e<=0||e>=17)&&(e=a),e},e.prototype._getMapOptionZoomMin=function(t){var e,o=this,a=t,n=null,r=parseInt(o.$map.attr("data-zoom-min"));try{n=parseInt(o.settings.map.zoom_min)}catch(t){}return e="number"==typeof r&&r>0?r:"number"==typeof n&&n>0?o.settings.map.zoom:a,(e<=0||e>=17)&&(e=a),e},e.prototype._getMapOptionZoomMax=function(t){var e,o=this,a=t,n=null,r=parseInt(o.$map.attr("data-zoom-max"));try{n=parseInt(o.settings.map.zoom_max)}catch(t){}return e="number"==typeof r&&r>0?r:"number"==typeof n&&n>0?o.settings.map.zoom:a,(e<=0||e>=17)&&(e=a),e},e.prototype._getMapOptionType=function(t){var e,o=this,a=t,n=null,r=o.$map.attr("data-type");try{n=parseInt(o.settings.map.type)}catch(t){}return e="string"==typeof r&&void 0!==r?r:"string"==typeof n&&void 0!==n?o.settings.map.zoom:a,"roadmap"===e&&"satellite"===e&&"hybrid"===e&&"terrain"===e||(e=t),e},e.prototype._getMapOptionClustering=function(t){var e=this,o=t,a=null,n=e.$map.attr("data-clustering");try{a=parseInt(e.settings.map.clustering)}catch(t){}return"boolean"!=typeof n||"true"==typeof n&&"false"==typeof n?"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?o:e.settings.map.clustering:n},e.prototype._getMapControlZoom=function(t){var e=this,o=t,a=null,n=e.$map.attr("data-control-zoom");try{a=parseInt(e.settings.control.zoom)}catch(t){}return"boolean"!=typeof n||"true"==typeof n&&"false"==typeof n?"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?o:e.settings.control.zoom:n},e.prototype._getMapControlType=function(t){var e=this,o=t,a=null,n=e.$map.attr("data-control-type");try{a=parseInt(e.settings.control.type)}catch(t){}return"boolean"!=typeof n||"true"==typeof n&&"false"==typeof n?"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?o:e.settings.control.type:n},e.prototype._getMapControlScale=function(t){var e=this,o=t,a=null,n=e.$map.attr("data-control-scale");try{a=parseInt(e.settings.control.scale)}catch(t){}return"boolean"!=typeof n||"true"==typeof n&&"false"==typeof n?"boolean"!=typeof a||"true"==typeof a&&"false"==typeof a?o:e.settings.control.scale:n},e.prototype._getMapControlStreetView=function(e){var o=this,a=t(e).attr("data-control-streetview");return o.___getBoolean(a,!1)},e.prototype._getMapControlRotate=function(e){var o=this,a=t(e).attr("data-control-rotate");return o.___getBoolean(a,!1)},e.prototype._getMapControlFullscreen=function(e){var o=this,a=t(e).attr("data-control-fullscreen");return o.___getBoolean(a,!1)},e.prototype._getMapEventDraggable=function(e){var o=this,a=t(e).attr("data-event-draggable");return o.___getBoolean(a,!0)},e.prototype._getMapEventDoubleClickZoom=function(e){var o=this,a=t(e).attr("data-event-doubleclick"),n=o.___getBoolean(a,!0);return n=!1===n},e.prototype._getMapEventMouseWheel=function(e){var o=this,a=t(e).attr("data-event-mousewheel");return o.___getBoolean(a,!1)},e.prototype._getMapStyle=function(t){try{return t.style}catch(t){return!1}},e.prototype.getLocations=function(e){var o=this,a=t(e).find(".marker"),n=[];return a.each(function(e,a){var a={id:o.getMarkerID(a),lat:t(a).attr("data-lat"),lng:t(a).attr("data-lng"),html:t(a).html(),icon:o.getMarkerIcon(a),draggable:o.getMarkerEventDraggable(a)};n.push(a)}),n},e.prototype.mapInit=function(){var e=this,o={};if(o.zoom=e.config.map.options.zoom,o.minZoom=e.config.map.options.zoom_min,o.maxZoom=e.config.map.options.zoom_max,o.mapTypeId=e.config.map.options.type,o.zoomControl=e.config.map.controls.zoom,o.mapTypeControl=e.config.map.controls.type,o.scaleControl=e.config.map.controls.scale,o.streetViewControl=e.config.map.controls.streetView,o.rotateControl=e.controlRotate,o.fullscreenControl=e.controlFullscreen,o.draggable=e.eventDraggable,o.disableDoubleClickZoom=e.eventDoubleClickZoom,o.scrollwheel=e.eventMouseWheel,console.log(e),e.$map.addClass("googlemap").addClass("googlemap-load"),!1!==e.config.map.style&&(o.styles=e.config.map.style),e.map=new google.maps.Map(e.$canvas.get(0),o),t.each(e.locations,function(t,o){e.addMarker(o)}),e.$map.trigger("onLoad"),e.setCenter(),e.config.map.options.clustering){new MarkerClusterer(e.map,e.markers,{imagePath:"//developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},e.prototype.getMarkerID=function(e){var o=this,a=t(e).attr("data-id");return a=void 0===a?o.___randomId(10):o.___slugify(a)},e.prototype.getMarkerIcon=function(e){var o=t(e).attr("data-marker-image"),a=parseInt(t(e).attr("data-marker-width")),n=parseInt(t(e).attr("data-marker-height"));return!(void 0===o||!t.isNumeric(a)||!t.isNumeric(n))&&{url:o,width:a,height:n}},e.prototype.getMarkerEventDraggable=function(e){var o=Boolean(t(e).attr("data-draggable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.getMarkerEventClickeable=function(e){var o=Boolean(t(e).attr("data-clickeable"));return void 0!==o&&""!==o||(o=!1),o},e.prototype.addMarker=function(e){var o=this,a={};if(a.id=e.id,a.position=new google.maps.LatLng(e.lat,e.lng),a.map=o.map,a.clickable=!0,a.animation=google.maps.Animation.DROP,!1!==e.icon){a.icon=e.icon;e.icon.url,new google.maps.Size(e.icon.width,e.icon.height)}!1!==e.draggable&&(a.draggable=!0);var n=new google.maps.Marker(a);o.markers.push(n);var r=new google.maps.InfoWindow({content:e.html});o.infowindows.push(r),n.addListener("click",function(){t.each(o.infowindows,function(t,e){e.close()}),r.open(o.map,n),o.map.setCenter(this.getPosition());var a={};a.lat=parseFloat(n.getPosition().lat()),a.lng=parseFloat(n.getPosition().lng()),o.$map.trigger("onMarkerClick",[a,e.id])}),o.map.setCenter(a.position)},e.prototype.openMarker=function(e){var o=this;t.each(o.markers,function(t,o){o.id===e&&new google.maps.event.trigger(o,"click")})},e.prototype.setCenter=function(){var e=this,o=new google.maps.LatLngBounds;t.each(e.locations,function(t,e){var a=new google.maps.LatLng(e.lat,e.lng);o.extend(a)}),1===e.locations.length?e.map.setCenter(o.getCenter()):e.map.fitBounds(o)},e.prototype.reload=function(){var t=this;t._init(t.element)},e.prototype.destroy=function(){},e.prototype.___getBoolean=function(t,e){var o=e;return"true"===t?o=!0:"false"===t&&(o=!1),o},e.prototype.___slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},e.prototype.___randomId=function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="",a=0;a<t;a++){var n=Math.floor(Math.random()*e.length);o+=e.substring(n,n+1)}return o.toLowerCase()},t.fn.gmaps=function(){var t,o,a=this,n=arguments[0],r=Array.prototype.slice.call(arguments,1),p=a.length;for(t=0;t<p;t++)if("object"==typeof n||void 0===n?a[t].gmap=new e(a[t],n,t):o=a[t].gmap[n].apply(a[t].gmap,r),void 0!==o)return o;return a}}(jQuery);