!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";var t=window.Gmaps||{};t=function(){function t(t,o,a){var r=this;r.element=t,r.settings=o,r.$canvas=null,r.$map=e(t),r.index=a,r.id="jquery-gmaps-"+a,r._init(r.element)}return t}(),t.prototype._init=function(e){var t=this;t.getMapSettings(),t._canvas(e),t._scripts()},t.prototype._canvas=function(t){var o=this;o.$map.find(".googlemap-overview").length>0&&o.$map.find(".googlemap-overview").remove();var a=document.createElement("div");return e(a).addClass("googlemap-overview"),e(a).addClass(o.id),e(t).prepend(e(a)),o.$canvas=e(a)},t.prototype._scripts=function(){var t=this;if(0===e("#gmaps-api").length){var o="//maps.googleapis.com/maps/api/js";if(!t.key)return!1;o+="?key="+t.key;var a=document.createElement("script");if(a.type="text/javascript",a.src=o,a.id="gmaps-api",a.async=!0,a.defer=!0,document.body.appendChild(a),t.clustering){var r=document.createElement("script");r.type="text/javascript",r.src="//developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js",r.id="gmaps-clustering",r.async=!0,r.defer=!0,document.body.appendChild(r)}}var n=setInterval(function(){void 0!==window.google&&(window.clearInterval(n),t.mapInit())},200)},t.prototype.getMapSettings=function(){var e=this;e.map=null,e.markers=[],e.bounds=null,e.infowindows=[],e.key=e.getMapKey(e.element),e.zoom=e.getMapZoom(e.element),e.clustering=e.getMapClustering(e.element),e.lang=e.getMapLanguage(),e.style=e.getMapStyle(e.settings),e.controlZoom=e.getMapControlZoom(e.element),e.controlType=e.getMapControlType(e.element),e.controlScale=e.getMapControlScale(e.element),e.controlStreetView=e.getMapControlStreetView(e.element),e.controlRotate=e.getMapControlRotate(e.element),e.controlFullscreen=e.getMapControlFullscreen(e.element),e.eventDraggable=e.getMapEventDraggable(e.element),e.eventDoubleClickZoom=e.getMapEventDoubleClickZoom(e.element),e.eventMouseWheel=e.getMapEventMouseWheel(e.element),e.locations=e.getLocations(e.element)},t.prototype.getMapLanguage=function(){var t=e("html"),o=t.attr("lang");return void 0!==o&&""!==o||(o="en"),o},t.prototype.getMapKey=function(t){return e(t).attr("data-key")},t.prototype.getMapZoom=function(t){var o=e(t).attr("data-zoom");return o="string"!=typeof o?4:parseInt(o)},t.prototype.getMapClustering=function(t){var o=Boolean(e(t).attr("data-clustering"));return void 0===o&&(o=!1),o},t.prototype.getMapControlZoom=function(t){var o=this,a=e(t).attr("data-control-zoom");return o.___getBoolean(a,!1)},t.prototype.getMapControlType=function(t){var o=this,a=e(t).attr("data-control-type");return o.___getBoolean(a,!1)},t.prototype.getMapControlScale=function(t){var o=this,a=e(t).attr("data-control-scale");return o.___getBoolean(a,!1)},t.prototype.getMapControlStreetView=function(t){var o=this,a=e(t).attr("data-control-streetview");return o.___getBoolean(a,!1)},t.prototype.getMapControlRotate=function(t){var o=this,a=e(t).attr("data-control-rotate");return o.___getBoolean(a,!1)},t.prototype.getMapControlFullscreen=function(t){var o=this,a=e(t).attr("data-control-fullscreen");return o.___getBoolean(a,!1)},t.prototype.getMapEventDraggable=function(t){var o=this,a=e(t).attr("data-event-draggable");return o.___getBoolean(a,!0)},t.prototype.getMapEventDoubleClickZoom=function(t){var o=this,a=e(t).attr("data-event-doubleclick"),r=o.___getBoolean(a,!0);return r=!1===r},t.prototype.getMapEventMouseWheel=function(t){var o=this,a=e(t).attr("data-event-mousewheel");return o.___getBoolean(a,!1)},t.prototype.getMapStyle=function(e){try{return e.style}catch(e){return!1}},t.prototype.getLocations=function(t){var o=this,a=e(t).find(".marker"),r=[];return a.each(function(t,a){var a={id:o.getMarkerID(a),lat:parseFloat(e(a).attr("data-lat")),lng:parseFloat(e(a).attr("data-lng")),html:e(a).html(),icon:o.getMarkerIcon(a),draggable:o.getMarkerEventDraggable(a)};r.push(a)}),r},t.prototype.mapInit=function(){var t=this,o={};if(o.zoom=t.zoom,o.zoomControl=t.controlZoom,o.mapTypeControl=t.controlType,o.scaleControl=t.controlScale,o.streetViewControl=t.controlStreetView,o.rotateControl=t.controlRotate,o.fullscreenControl=t.controlFullscreen,o.draggable=t.eventDraggable,o.disableDoubleClickZoom=t.eventDoubleClickZoom,o.scrollwheel=t.eventMouseWheel,t.$map.addClass("googlemap").addClass("googlemap-load"),!1!==t.style&&(o.styles=t.style),t.map=new google.maps.Map(t.$canvas.get(0),o),e.each(t.locations,function(e,o){t.addMarker(o)}),t.$map.trigger("onLoad"),t.setCenter(),t.clustering){new MarkerClusterer(t.map,t.markers,{imagePath:"//developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},t.prototype.getMarkerID=function(t){var o=this,a=e(t).attr("data-id");return"marker_"+(a=void 0===a?o.___id(10):o.___slugify(a))},t.prototype.getMarkerIcon=function(t){var o=e(t).attr("data-marker-image"),a=parseInt(e(t).attr("data-marker-width")),r=parseInt(e(t).attr("data-marker-height"));return!(void 0===o||!e.isNumeric(a)||!e.isNumeric(r))&&{url:o,width:a,height:r}},t.prototype.getMarkerEventDraggable=function(t){var o=Boolean(e(t).attr("data-draggable"));return void 0!==o&&""!==o||(o=!1),o},t.prototype.addMarker=function(t){var o=this,a={};if(a.id=t.id,a.position=new google.maps.LatLng(t.lat,t.lng),a.map=o.map,a.clickable=!0,a.animation=google.maps.Animation.DROP,!1!==t.icon){a.icon=t.icon;t.icon.url,new google.maps.Size(t.icon.width,t.icon.height)}!1!==t.draggable&&(a.draggable=!0);var r=new google.maps.Marker(a);o.markers.push(r);var n=new google.maps.InfoWindow({content:t.html});o.infowindows.push(n),r.addListener("click",function(){e.each(o.infowindows,function(e,t){t.close()}),n.open(o.map,r),o.map.setCenter(this.getPosition());var a={};a.lat=parseFloat(r.getPosition().lat()),a.lng=parseFloat(r.getPosition().lng()),o.$map.trigger("onMarkerClick",[a,t.id])}),o.map.setCenter(a.position)},t.prototype.setCenter=function(){var t=this,o=new google.maps.LatLngBounds;e.each(t.locations,function(e,t){var a=new google.maps.LatLng(t.lat,t.lng);o.extend(a)}),1===t.locations.length?t.map.setCenter(o.getCenter()):t.map.fitBounds(o)},t.prototype.reload=function(){var e=this;e._init(e.element)},t.prototype.destroy=function(){},t.prototype.___getBoolean=function(e,t){var o=t;return"true"===e?o=!0:"false"===e&&(o=!1),o},t.prototype.___slugify=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},t.prototype.___id=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="",a=0;a<e;a++){var r=Math.floor(Math.random()*t.length);o+=t.substring(r,r+1)}return o.toLowerCase()},e.fn.gmaps=function(){var e,o,a=this,r=arguments[0],n=Array.prototype.slice.call(arguments,1),l=a.length;for(e=0;e<l;e++)if("object"==typeof r||void 0===r?a[e].gmap=new t(a[e],r,e):o=a[e].gmap[r].apply(a[e].gmap,n),void 0!==o)return o;return a}});